{% extends "layouts/base.html" %}
{% load static %}
{% block title %}Perfiles{% endblock %}
{% block titulo-pagina %}Perfiles{% endblock %};
{% block breadcrumb %}
<ol class="breadcrumb float-sm-right px-3">
  <li class="breadcrumb-item text-muted  ">Bases </li>
  <li class="breadcrumb-item"><a href="{% url 'perfiles_listar' %}" class="text-muted text-decoration-none">Perfiles</a>
  </li>
  <li class="breadcrumb-item active"> 
    {%if request.resolver_match.url_name == "perfiles_editar" %} 
    Editar 
    {% else %}
    Crear 
    {% endif %}</li>
</ol>
{% endblock %};
{% load crispy_forms_tags %}

{% block content %}

<form class="needs-validation " novalidate method="POST">
  <!-- Security token -->
  {% csrf_token %}

  <div class="row">
    <div class="col-12 col-md-10 m-auto 
    {%if request.resolver_match.url_name != 'perfiles_editar' %}
            d-none
            {%endif%}
            ">
      <div class="form-row justify-content-center mb-5">
        <div class="form-group pt-2 col-12">
          <div class="card card-gray-dark mx-3">
            <div class="card-header ">
              <div class="card-title">
                Editar estado</div>
              <div class="card-tools">
                <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i>
                </button>
              </div>
            </div>
            <div class="d-none">
              {{form.activo}}
            </div>
            <div class="card-body py-2 px-1" title="Click para cambiar">
              {%if object.activo%}
              <button type="button" class="btn btn-flat btn-block btn-success p-2" id="label_activo">activo</button>
              {%else%}
              <button type="button" class="btn btn-flat btn-block btn-danger p-2" id="label_activo">Desactivado</button>
              {%endif%}
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-10 m-auto">
      <div class="card card-gray-dark mx-3">
        <div class="card-header ">
          <div class="card-title">
            {%if request.resolver_match.url_name == "perfiles_editar" %} Editar
            {% else %}
            Agregar
            {% endif %}
            datos personales
          </div>
          <div class="card-tools">
            <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i>
            </button>
          </div>

        </div>
        <div class="card-body mt-3">
          <div class="form-row">
            <div class="form-group pt-2 col-md-4">
              {{form.nombres| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-3">
              {{form.apellidos| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-4 col-md-2">
              {{form.tipo_doc| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-8 col-md-3">
              {{form.documento| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-4">
              {{form.nacionalidad| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-4">
              {{form.fecha_nacimiento| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-4">
              {{form.sexo| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-5">
              {{form.calle| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-4 col-md-2">
              {{form.altura| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-4 col-md-2">
              {{form.piso| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-4 col-md-3">
              {{form.departamento| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-12 col-md-4">
              {{form.comuna| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-12 col-md-4">
              {{form.barrio| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-12 col-md-4">
              {{form.provincia| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-3">
              {{form.telefono| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-3">
              {{form.email| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-3">
              {{form.instagram| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-3">
              {{form.facebook| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-3">
              {{form.equipo_futbol| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-3 
            {%if request.resolver_match.url_name != 'perfiles_editar' %} 
            d-none
            {% endif %}
            " id="socio_futbol">
              {{form.socio_futbol| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-3">
              {{form.profesion| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-3 
            {%if request.resolver_match.url_name != 'perfiles_editar' %} 
            d-none
            {% endif %}
            " id="matriculado">
              {{form.matriculado| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-3">
              {{form.es_militante| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-3">
              {{form.es_empleadoGCBA| as_crispy_field}}
            </div>
            <div class="form-group mt-4 col-12">
              {{form.observaciones| as_crispy_field}}
            </div>
          </div>
        </div>
      </div>

    </div>
    <div class="col-12 col-md-10 text-center m-auto">
      <div class="mt-3">
        {%if request.resolver_match.url_name == "perfiles_editar" %}
        <a href="{% url 'perfiles_ver' object.id %}" class="btn btn-secondary">Volver</a>
        {% else %}
        <a href="{% url 'perfiles_listar' %}" class="btn btn-secondary">Cancelar</a>

        {% endif %}
        <button type="submit" class="btn btn-primary">Guardar</button>
      </div>
    </div>
  </div>
</form>

{% endblock content%}

{% block customJS %}
<script>

  $(document).ready(function () {

    // custom checkbox actvio
    $('#label_activo').click(function () {
      if ($('#label_activo').hasClass("btn-success")) {
        $('#label_activo').removeClass("btn-success").addClass("btn-danger").text('Desactivado');
        $('#id_activo').prop('checked', false);
      } else {
        $('#label_activo').removeClass("btn-danger").addClass("btn-success").text('Activo');
        $('#id_activo').prop('checked', true);
      };
    });




  });


  // Obtener el campo de selección
  const equipoFutbolSelect = $("#id_equipo_futbol");

  // Obtener el campo socio_futbol
  const campoSocioFutbol = $("#socio_futbol");

  // Escuchar cambios en el campo de selección
  equipoFutbolSelect.on("change", function () {
    // Verificar si se ha seleccionado alguna opción
    if (equipoFutbolSelect.val() !== "") {
      // Mostrar el campo socio_futbol si se seleccionó alguna opción
      if (campoSocioFutbol.hasClass("d-none")){
        campoSocioFutbol.removeClass("d-none");
      }
      $("#id_socio_futbol").val("False");
      
    } else {
      // Ocultar el campo socio_futbol si no se seleccionó ninguna opción
      $("#id_socio_futbol").val("False");
      campoSocioFutbol.addClass("d-none");
    }
  });
  // Obtener el campo de selección de profesion
  const profesionSelect = $("#id_profesion");

  // Obtener el campo matriculado
  const campoMatriculado = $("#matriculado");

  // Escuchar cambios en el campo de selección
  profesionSelect.on("change", function () {
    // Verificar si se ha seleccionado alguna opción
    if (profesionSelect.val() !== "") {
      // Mostrar el campo matriculado si se seleccionó alguna opción
      if (campoMatriculado.hasClass("d-none")){campoMatriculado.removeClass("d-none");}        
      $("#id_matriculado").val("False");
      
    } else {
      // Ocultar el campo matriculado si no se seleccionó ninguna opción
      $("#id_matriculado").val("False");
      campoMatriculado.addClass("d-none");
    }
  });
</script>
{% endblock customJS%}