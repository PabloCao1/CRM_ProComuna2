{% extends "layouts/base.html" %}
{% load static %}
{% block title %}Perfiles{% endblock %}
{% block titulo-pagina %}Perfiles{% endblock %};
{% block breadcrumb %}
<ol class="breadcrumb float-sm-right px-3">
  <li class="breadcrumb-item text-muted  ">Bases </li>
  <li class="breadcrumb-item"><a href="{% url 'perfiles_listar' %}" class="text-muted text-decoration-none">Perfiles</a>
  </li>
  <li class="breadcrumb-item active"> Editar </li>
</ol>
{% endblock %};
{% load crispy_forms_tags %}

{% block content %}

<form class="needs-validation " novalidate method="POST">
  <!-- Security token -->
  {% csrf_token %}

  <div class="row">
    <div class="col-12 col-md-10 m-auto ">
      <div class="form-row justify-content-center ">
        <div class="form-group pt-2 col-12">
          <div class="card card-gray-dark mx-3">
            <div class="card-header ">
              <div class="card-title">
                Editar estado</div>
              <div class="card-tools">
                <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i>
                </button>
              </div>
            </div>
            <div class="d-none">
              {{form.activo}}
            </div>
            <div class="card-body py-2 px-1" title="Click para cambiar">
              {%if form.activo%}
              <button type="button" class="btn btn-flat btn-block btn-success p-2" id="label_activo">activo</button>
              {%else%}
              <button type="button" class="btn btn-flat btn-block btn-danger p-2" id="label_activo">Desactivado</button>
              {%endif%}
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-10 m-auto">
      
      <div class="card card-gray-dark mx-3 mb-4">
        <div class="card-header ">
          <div class="card-title">
            Editar datos personales
          </div>
          <div class="card-tools">
            <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i>
            </button>
          </div>

        </div>
        <div class="card-body mt-3">
          <div class="form-row">
            <div class="form-group pt-2 col-md-6">
              {{form.nombres| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-6">
              {{form.apellidos| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-4 col-md-3">
              {{form.tipo_doc| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-8 col-md-3">
              {{form.documento| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-3">
              {{form.sexo| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-3">
              {{form.fecha_nacimiento| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-5">
              {{form.calle| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-4 col-md-2">
              {{form.altura| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-4 col-md-2">
              {{form.piso| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-4 col-md-3">
              {{form.departamento| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-12 col-md-4">
              {{form.comuna| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-12 col-md-4">
              {{form.barrio| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-12 col-md-4">
              {{form.provincia| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-3">
              {{form.telefono| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-3">
              {{form.email| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-3">
              {{form.instagram| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-3">
              {{form.facebook| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-sm-4">
              {{form.fecha_ingreso| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-sm-4">
              {{form.es_militante| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-sm-4">
              {{form.es_empleadoGCBA| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-12">
              {{form.observaciones| as_crispy_field}}
            </div>
          </div>
        </div>
      </div>

      {%if perms.Usuarios.base_voluntarios %}
      <div class="card card-gray-dark mx-3 mb-4">
        <div class="card-header ">
          <div class="card-title">
            Editar en base voluntarios
          </div>
          <div class="card-tools">
            <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i>
            </button>
          </div>

        </div>
        <div class="card-body mt-3">
          <div class="form-row mb-3">
            <div class="form-group pt-2 col-12 d-none">
              {{form_voluntarios.fk_perfil_v| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-12">
              {{form_voluntarios.grupo_wsp| as_crispy_field}}
            </div>
            <div class="form-group  col-12">
              {{form_voluntarios.gen_23| as_crispy_field}}
            </div>
            <div class="form-group  col-12">
              {{form_voluntarios.eventos| as_crispy_field}}
            </div>
          </div>
          <div class="form-row">
            <div class="form-group pt-2 col-md-6">
              {{form_voluntarios.equipo_futbol| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-md-6">
              {{form_voluntarios.afinidad| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-12 d-none" id="otro">
              {{form_voluntarios.otro_afinidad| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-12">
              {{form_voluntarios.observaciones_v| as_crispy_field}}
            </div>
          </div>
        </div>
      </div>
      {% endif %}

      {%if perms.Usuarios.base_fiscales %}
      <div class="card card-gray-dark mx-3 mb-4">
        <div class="card-header ">
          <div class="card-title">
            Editar en base fiscales
          </div>
          <div class="card-tools">
            <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i>
            </button>
          </div>

        </div>
        <div class="card-body mt-3">
          <div class="form-row mb-3">
            <div class="form-group pt-2 col-12 d-none">
              {{form_fiscales.fk_perfil_f| as_crispy_field}}
            </div>
            <div class="form-group pt-2 col-12">
              {{form_fiscales.fue_fiscal| as_crispy_field}}
            </div>
          </div>
          <div class="form-row mb-3">
            <div class="form-group col-md-3">
              {{form_fiscales.fecha_fiscal| as_crispy_field}}
            </div>
            <div class="form-group col-md-3">
              {{form_fiscales.rol_fiscal| as_crispy_field}}
            </div>
            <div class="form-group col-md-3">
              {{form_fiscales.disp_jornada| as_crispy_field}}
            </div>
            <div class="form-group col-md-3">
              {{form_fiscales.desempeno| as_crispy_field}}
            </div>
            <div class="form-group col-12">
              {{form_fiscales.observaciones_f| as_crispy_field}}
            </div>
          </div>
        </div>
      </div>
      {% endif %}
    </div>
    <div class="col-12 col-md-10 text-center m-auto">
      <div class="mt-3">
        {%if request.resolver_match.url_name == "perfiles_editar" %}
        <a href="{% url 'perfiles_ver' object.id %}" class="btn btn-secondary">Volver</a>
        {% else %}
        <a href="{% url 'perfiles_listar' %}" class="btn btn-secondary">Cancelar</a>        
        {% endif %}
        <button type="submit" class="btn btn-primary">Guardar</button>
      </div>
    </div>
  </div>
</form>

{% endblock content%}

{% block customJS %}
<script>

  $(document).ready(function () {

    $('#id_afinidad').onchange = (evt) => {
      var seleccion = $("#id_afinidad option:selected").text();
      alert(seleccion)
      if (seleccion == 'Otro') {
        $("#otro").removeClass('d-none');
      }
      else {
        $("#otro").addClass('d-none')
      }
    };

    // custom checkbox actvio
    $('#label_activo').click(function () {
      if ($('#label_activo').hasClass("btn-success")) {
        $('#label_activo').removeClass("btn-success").addClass("btn-danger").text('Desactivado');
        $('#id_activo').prop('checked', false);
      } else {
        $('#label_activo').removeClass("btn-danger").addClass("btn-success").text('Activo');
        $('#id_activo').prop('checked', true);
      };
    });




  });
</script>
{% endblock customJS%}