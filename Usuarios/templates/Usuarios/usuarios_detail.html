{% extends "layouts/base.html" %}
{% load static %}
{% load crispy_forms_tags %}

{% block title %}Usuarios{% endblock %}
{% block titulo-pagina %}Usuario{% endblock %};

{% block breadcrumb %}
<ol class="breadcrumb float-sm-right ">
    <li class="breadcrumb-item "> Administración</li>
    <li class="breadcrumb-item"><a href="{% url 'usuarios_listar' %}">Usuarios</a></li>
    <li class="breadcrumb-item active"> {{ object.usuario}}</li>
</ol>
{% endblock %};

{% block content %}

<div class="row">
    <!-- botones -->
    <div class="col-12 my-3 mx-2 d-print-none">
        {% if request.user.usuarios.id == object.id %}
            <a href="{% url 'perfil_editar' object.id %}" class="btn btn-primary mr-1">Editar</a>
            <a href="{% url 'cambiar_password' %}" class="btn btn-secondary mr-1">Cambiar Contraseña</a>
        {% elif perms.Usuarios.rol_admin %}
            <a href="{% url 'usuarios_editar' object.id %}" class="btn btn-primary mr-1">Editar</a>        
            <a href="{% url 'password_reset' object.id %}" class="btn btn-secondary mr-1"> Resetear Contraseña</a>
            <a href="{% url 'usuarios_eliminar' object.id %}" class="btn btn-danger mr-1">Eliminar</a>
        {% endif %}
    </div>
    <!-- ./botones -->
</div>

<div class="row">
    <div class="col-sm-3">
        <div class="card card-gray-dark card-outline">
            <div class="card-header mr-2 ml-2 mt-2 p-0">
                {% if object.imagen != "default.png"%}
                <img class="card-img-top" src="{{object.imagen.url}}" alt="User profile picture" />
                {% else %}
                <img class="card-img-top" src="{% static 'images/perfil.png'%}" alt="User profile picture" />
                {% endif %}
            </div>
            <div class="card-footer card-comments p-2">
                <ul class="nav nav-pills flex-column">
                    <li class="nav-item"></li>
                    <li class="nav-item">
                        <div class="comment-text">
                            Estado
                            <span class="username">
                                {% if object.usuario.is_active %}
                                <span class="text-success">Activo</span>
                                {% else %}
                                <span class="text-danger">Inactivo</span>
                                {% endif %}
                            </span>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="col-sm-5">
        <div class="row">
            <div class="col">
                <div class="card card-gray-dark  card-outline">
                    <div class="card-header">
                        <div class="card-title">
                            Datos del usuario
                        </div>
                    </div>
                    <div class="card-footer card-comments p-2">
                        <ul class="nav nav-pills flex-column">
                            <li class="nav-item">
                                <div class="comment-text">
                                    Usuario
                                    <span class="username">{{object.usuario}}</span>
                                </div>
                            </li>
                            <li class="nav-item">
                                <div class="comment-text">
                                    Nombre
                                    <span class="username">{{object.usuario.first_name|default_if_none:"-"|default:"-"}}</span>
                                </div>
                            </li>
                            <li class="nav-item">
                                <div class="comment-text">
                                    Apellido
                                    <span class="username">{{object.usuario.last_name|default_if_none:"-"|default:"-"}}</span>
                                </div>
                            </li>
                            <li class="nav-item">
                                <div class="comment-text">
                                    DNI
                                    <span
                                        class="username">{{object.dni|default_if_none:"-"|default:"-"}}</span>
                                </div>
                            </li>
                            <li class="nav-item">
                                <div class="comment-text">
                                    EMAIL
                                    <span class="username">{{object.usuario.email|default_if_none:"-"|default:"-"}}</span>
                                </div>
                            </li>
                            <li class="nav-item">
                                <div class="comment-text">
                                    Telefono
                                    <span
                                        class="username">{{object.telefono|default_if_none:"-"|default:"-"}}</span>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-sm-4">
        <div class="card card-gray-dark card-outline">
            <div class="card-header">
                <div class="card-title">
                    Permisos
                </div>
            </div>
            <div class="card-footer card-comments p-2">
                <ul class="nav nav-pills flex-column">
                    <li class="nav-item">
                    </li>
                    <li class="nav-item">
                        <div class="comment-text">
                            Grupos de usuario
                            <span class="username">
                                <ul class="list-unstyled m-0">
                                    {%for g in object.usuario.user_permissions.all %}
                                            <li class="badge badge-info">{{g|cut:"Usuarios | Usuario |"}}</li>
                                    {%empty%}
                                    <li><span class="font-weight-bold">-</span></li>
                                    {%endfor%}
                                </ul>
                            </span>
                        </div>
                    </li>

                </ul>
            </div>
        </div>
    </div>
</div>
{% if perms.Usuarios.rol_admin %}
<div class="row mt-4 d-print-none">
    <div class="col-12 mx-2">
      <a href="{% url 'usuarios_listar'%}" class="btn btn-secondary">Volver</a>
    </div>
  </div>
  {% endif %}

{% endblock content %}


{% block customJS %}
{% endblock %}
